{% include 'layouts/base.html'   %}
{% block head %}
    
{% endblock %}

{% block body %}

    <div class="container__efectivo">
        <h2>Pago en Efectivo</h2>
        <form id="form-efectivo">
            <div class="cotainer__input">
                <label for="nombre">
                    Nombre:
                </label>
                <input type="text" name="nombre" id="monto" required min="1">
            </div>

            <div class="container__input">
                <label for="monto-hidden">
                    Monto a Pagar:
                </label>
                <span id="monto-a-pagar">$0.00</span>
                <input type="hidden" name="monto" id="monto-hidden">
            </div>

            <button type="submit">Pagar</button>
        </form>
        <div id="alerta-pendiente" style="display: none; padding: 10px; margin-top: 10px;">
            <p>
                Esperando confirmacion del pago...
            </p>
        </div>
        <button id="confirmar-pago" style="display: none; margin-top: 10px;">Confirmar Pago</button>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const formEfectivo = document.getElementById("form-efectivo");
            const alertaPendiente = document.getElementById("alerta-pendiente");
            const btnConfirmar = document.getElementById("confirmar-pago");
        
            formEfectivo.addEventListener("submit", (e) => {
                e.preventDefault();
                alertaPendiente.style.display = "block";
                btnConfirmar.style.display = "block";
            });
        
            btnConfirmar.addEventListener("click", () => {
                localStorage.setItem("pago_confirmado", "true");
                localStorage.removeItem("carrito");
                alert("Pago en efectivo confirmado. Procesando pedido...");
                window.location.href = "/ver-carrito";
            });

            const montoAPagar = document.getElementById("monto-a-pagar");
            const montoHidden = document.getElementById("monto-hidden");
        
            setTimeout(() => {
                // Obtener total del localStorage
                const total = localStorage.getItem("total") || "0.00";
                console.log("Monto obtenido del localStorage:", total);
                // Mostrar el monto correctamente
                montoAPagar.textContent = `$${total}`;
                montoHidden.value = total;
            }, 500)
        })
    </script>

{% endblock %}